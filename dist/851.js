(()=>{"use strict";importScripts("/src/utils/sjcl.js"),self.onmessage=e=>{const{type:s,data:r,password:t}=e.data;try{let e;if("encrypt"===s)e=((e,s)=>sjcl.encrypt(s,e,{ks:256}))(r,t);else if("decrypt"===s)e=((e,s)=>{try{return sjcl.decrypt(s,e)}catch(e){throw e instanceof sjcl.exception.corrupt?new Error("Decryption failed: Incorrect password or corrupted file."):e instanceof sjcl.exception.invalid?new Error("Decryption failed: Invalid SJCL data format."):new Error(`Decryption failed: ${e.message||"Unknown error"}`)}})(r,t);else if("stringify"===s)e=(e=>JSON.stringify(e))(r);else{if("parse"!==s)throw new Error("Unknown worker message type");e=(e=>JSON.parse(e))(r)}self.postMessage({status:"success",result:e})}catch(e){self.postMessage({status:"error",message:e.message})}}})();